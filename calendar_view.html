<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📅 지킴이 일정 관리</title>

    <!-- Pikaday CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pikaday/pikaday.min.css">

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            text-align: center;
            background: #F8F1E9;
            padding: 20px;
            margin: 0;
        }

        h1 {
            color: #333;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .calendar-container {
            max-width: 100%;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .input-container {
            margin-bottom: 10px;
        }

        input[type="text"] {
            padding: 12px;
            width: 90%;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }

        button {
            background-color: #007bff;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .color-picker {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .color-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: none;
            margin: 0 8px;
            cursor: pointer;
        }

        /* 모바일 최적화 */
        @media screen and (max-width: 768px) {
            .color-picker {
                margin-bottom: 15px;
            }
            .calendar-container {
                padding: 10px;
            }
            h1 {
                font-size: 20px;
            }
            input[type="text"], button {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <h1>📅 지킴이 일정 관리</h1>

    <!-- 색상 선택 -->
    <div class="color-picker">
        <button class="color-btn" style="background: black;" onclick="setColor('black')"></button>
        <button class="color-btn" style="background: red;" onclick="setColor('red')"></button>
        <button class="color-btn" style="background: blue;" onclick="setColor('blue')"></button>
        <button class="color-btn" style="background: green;" onclick="setColor('green')"></button>
    </div>

    <div class="calendar-container">
        <div class="input-container">
            <input type="text" id="datepicker" placeholder="날짜를 선택하세요">
        </div>

        <div class="input-container">
            <input type="text" id="textInput" placeholder="일정에 대한 추가 정보를 입력하세요">
        </div>

        <button onclick="submitData()">제출</button>
        <h3>저장된 일정</h3>
        <div id="saved-events"></div> <!-- Firebase에서 가져온 이벤트 표시 -->
    </div>

    <!-- Pikaday JS -->
    <script src="https://cdn.jsdelivr.net/npm/pikaday/pikaday.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database-compat.js"></script>

    <script>
        // Firebase 설정
        const firebaseConfig = {
            apiKey: "AIzaSyAwXlQewHZxYLbZMkoKhm9HYsj6R8oPEpA",
            authDomain: "museum-web-370cd.firebaseapp.com",
            databaseURL: "https://museum-web-370cd-default-rtdb.firebaseio.com",
            projectId: "museum-web-370cd",
            messagingSenderId: "154810876093",
            appId: "1:154810876093:web:d9cc427254abfb609e37d4"
        };

        // Firebase 초기화
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let selectedColor = "black"; // 초기 색상 설정

        // 색상 선택 함수
        function setColor(color) {
            selectedColor = color;
        }

        // Pikaday 날짜 선택기
        var picker = new Pikaday({
            field: document.getElementById('datepicker'),
            format: 'YYYY-MM-DD',
            minDate: new Date(), // 오늘 이후의 날짜만 선택 가능
            maxDate: new Date(2025, 12, 31), // 최대 날짜 설정
        });

        // Firebase에서 일정 불러오기
        function loadEvents() {
            const savedEventsDiv = document.getElementById("saved-events");
            savedEventsDiv.innerHTML = ""; // 초기화

            const eventsRef = db.ref("events");
            eventsRef.once("value", function(snapshot) {
                snapshot.forEach(function(childSnapshot) {
                    const event = childSnapshot.val();
                    const eventElement = document.createElement("div");
                    eventElement.style.color = event.color;
                    eventElement.innerHTML = `<strong>${event.date}</strong>: ${event.name}`;
                    savedEventsDiv.appendChild(eventElement);
                });
            });
        }

        // 제출 버튼 클릭 시 Firebase에 저장하고 화면에 반영
        function submitData() {
            const selectedDate = document.getElementById('datepicker').value;
            const text = document.getElementById('textInput').value;

            if (selectedDate && text) {
                // Firebase에 저장
                const newEventRef = db.ref("events").push();
                newEventRef.set({
                    date: selectedDate,
                    name: text,
                    color: selectedColor
                });

                alert("일정이 저장되었습니다!");
                loadEvents(); // 저장된 일정 새로고침
            } else {
                alert("날짜와 내용을 모두 입력해주세요.");
            }
        }

        // 페이지 로딩 시 Firebase에서 이벤트 불러오기
        window.onload = function() {
            loadEvents();
        };
    </script>

</body>
</html>

